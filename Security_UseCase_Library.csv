Impac Kill Chain,Mitre [PRE & POST ATT&CK],Use Case,Tag,Description,Impact,Dependencies,Detection Logic (DL),DL Management,Output,Response,Comment,Refrence Number,Motivation/Group/Actor,Verified
Reconnaisance,,,,,,,,,,,,,,
,Technical Information Gathering|Discover target logon/email address format,Honey Email Token,Email Gateway,"A Honey email token is an email account that is placed in an organisation's public information sources for the purpose of detecting phishing campaigns, email address enumeration and spearphishing attempts (depending on the potential profile attached with the email address). Depending on the size of the organization will determine how many Honey Email tokens are created. Detection Logic should look for any activity that involve these email tokens as there is a high chance that this activity will indicate that an attacker/potential threat is looking for vulnerable users to exploit.",Medium,"* Email Gateway Logs
* Exchange Logs
* List of Honey Email Tokens
* Appproval to implement Tokens
* Fake social media sites
* Hidden Email contacts in web page contents",,,Alert and/or Report,"Determine Sending IP Address, Sender Email, Subject line, Attachments
Pivot on All values to determine if there are any commonalities to the delivery
Add the suspiciuos indicators to a list (to be used for later threat intellligence gathering)
Determine if this correlates with additional alerts related to phishing/spearphishing. 
If sender IP/Domain is suspicious - ensure they are blocked on Firewall/Email Gateway/Exchange ",,,,
,NA,Honeynet Activity,Network,"A Honeynet is a separate network that impersonates part of your corporate network but is used to bait out threats that are targetting your organization. Fake data and applications are set up in order to imitate a real network. Sensors and security controls should be set up in the environment in order to specifically detect attacker activity. Detecting honeynet is an extremely effecive way to detect threat activity and determine their behaviour. This use case is in the reconnaisance category because its main purpose is to detect an attackers methods, actions and objectvies. ",High,"* Network Segment designed to be a honeynet
* Security Controls such as EDR, NSM, IPS/IDS, Bro, Forensics
* Command Line logging
* Central logging /SIEM",,,,,,,,
,NA,Honey Site Activity,Web Application,"Similar to a Honeynet, a Honey Site is a honeypot used for detecting and determining web based attacks. ",,,,,,,,,,
,NA,Supply Chain Reconnaissance using OSINT,,,,, ,,,,,,,
, Technical Information Gathering|Conduct active scanning,Extnernal port scan [Firewall],Firewall,External Port Scan can be detected using either firewall log activity or IDS/IPS signatures. The benefit of this is to give context of which systems in your external environment are being scoped/targetted. This information should be used in reporting and threat intelligence gathering. ,Low,,,,,,,,,
, Technical Information Gathering|Conduct active scanning,Extnernal port scan [IDS/IPS],IDS/IPS,External Port Scan can be detected using either firewall log activity or IDS/IPS signatures. The benefit of this is to give context of which systems in your external environment are being scoped/targetted. This information should be used in reporting and threat intelligence gathering. ,Low,,,,,,,,,
, Technical Information Gathering|Conduct active scanning,External Ping Sweep [Firewall],Firewall,"External Ping Sweeps, like port scans, can also be detected using Network IDS/IPS, or WAF. The benefit of this is to give context of which systems in your external environment are being scoped/targetted. This information should be used in reporting and threat intelligence gathering.",Low,,,,,,,,,
, Technical Information Gathering|Conduct active scanning,External Ping Sweep [IDS/IPS],IDS/IPS,"External Ping Sweeps, like port scans, can also be detected using Network IDS/IPS, or WAF. The benefit of this is to give context of which systems in your external environment are being scoped/targetted. This information should be used in reporting and threat intelligence gathering.",Low,,,,,,,,,
,Technical Weakness Identification|Analyze application security posture,Extnernal Vulnerability Scan [IDS/IPS],IDS/IPS,"External Vulnerability Scans are indicative of a more serious threat than just port scans or ping sweeps. Any actor at this stage of  the attack life cycle is most likely looking for low hanging fruit (easily compromisable) vulnerabilities, or is heavily profiling the enviornment. External vulnerability scans should be done regularly by the vulnerability assessment/management team and their activity should be whitelisted and everything else blocked from the perimeter. This information should be used in reporting and threat intelligence gathering.",Medium,,,,,,,,,
,Technical Weakness Identification|Analyze application security posture,Extnernal Vulnerability Scan [WAF],IDS/IPS,"Just like External vulnerability scans,  this detection and prevention mechanism is done by the Web Application Firewall and focuses on web application attacks. Any actor at this stage of  the attack life cycle is most likely looking for low hanging fruit (easily compromisable) vulnerabilities, or is heavily profiling the enviornment. External vulnerability scans should be done regularly by the vulnerability assessment/management team and their activity should be whitelisted and everything else blocked from the perimeter. This information should be used in reporting and threat intelligence gathering.",Medium,,,,,,,,,
,,Local File Inclusion attempt [IDS/IPS],IDS/IPS|Web Attack,Attackers often test multiple vulnerabilities on web applications. An IPS should be able to detect this type of activity and this activity should be investigated. The actiity information should also be used for reporting and intelligence gathering,,,,,,,,,,
,,Local File Inclusion attempt [Reverse Proxy],Reverse Proxy| Web Attack,A reverse proxy is a good mechanism to detect attackers performing reconnaisance on web servers. This includes looking for local file inclusion attempts.,,,,,,,,,,
,,Web application information gathering detected [Reverese Proxy] ,Reverse Proxy| Web Attack,TBD,,,,,,,,,,
,,External Zone Transfer Request Detected [DNS],DNS,"Depending on your organizations DNS infrastrucutre (Split DNS or single DNS), you can detect DNS transfer request either by DNS logging and querying for zone transfer requests in the logs, or alternatively, look for Firewall/IDS traffic on port 53 using the TCP protocol. This use case has multiple entries, one for each detectino logic.",Medium,,,,,,,,,
,,External Zone Transfer Request Detected [Firewall],Firewall,"Depending on your organizations DNS infrastrucutre (Split DNS or single DNS), you can detect DNS transfer request either by DNS logging and querying for zone transfer requests in the logs, or alternatively, look for Firewall/IDS traffic on port 53 using the TCP protocol. This use case has multiple entries, one for each detectino logic.",Medium,,,,,,,,,
,,External Zone Transfer Request Detected [IDS/IPS],IDS/IPS,"Depending on your organizations DNS infrastrucutre (Split DNS or single DNS), you can detect DNS transfer request either by DNS logging and querying for zone transfer requests in the logs, or alternatively, look for Firewall/IDS traffic on port 53 using the TCP protocol. This use case has multiple entries, one for each detectino logic.",Medium,,,,,,,,,
,,Threat Intel Activity [Inbound IP Address],Threat Intel|Network,"This Use Case is mainly used as a form of reporting on any perimeter activity. This is a report based use case. This use case will heavily rely on the confidence rating  of an IOC and its relevancy to the organization. For example, if in financial services/banking, ensure financial related indicators and attacker group IP addresses are predominantly used. Secondly, ensure that the report will sort based on the confidence rating of a particular IP. The most important thing to get from this information is knowledge about who and when a potential threat is scanning your organization, and prepare for a pre-emptive attack. This use case is depenedant on how accurate, and current your threat intellgience feeds are and how well the feeds contextualize the data.",Medium,*Threat Intelligence feed,,,,,,,,
Delivery,,,,,,,,,,,,,,
,,Threat Intel Activity [High Confidence IP Address Hosting known attack infrasructure],Threat Intel|Network,"This Use Case has a heavy dependency on a threat intel provider, or your own organizations threat intelligence to have a confidence rating or accuracy and context of the threat intelligence. In other words, the IP addresses that correlates with threat intel information would need to be confirmed from a specific threat or ttp that would target your industry/veritcle and not just derived from a generic sample of IOC's. This is a good indicator that your organisation is being targeted by sophisiticated threat, or known opportunistic groups.",Medium,,,,,,,,,
,,Threat Intel Activity [Email Sender Address],Threat Intel|Email,"This use case correlates email addresses from gathered threat intelligence, that have been used or are being used by attackers. ",,,,,,,,,,
,,Suspicious Email Payload Detected,Email Sanbox,"This use case depends on whether an email sanbox has been set up the corporate network environment, and whether that has been configured to look for suspicious binaries or script code in email attachments (opensource example isCuckoo Sandbox https://cuckoosandbox.org/ ). If an attachment is found to be suspious it should be blocked (if there is a mechanism to do so) and an alert should be generated. ",,,,,,,,,,
,,Suspicious Email Link Detected,Email Sanbox,"This use case depends on whether an email sanbox has been set up the corporate network environment, and whether that has been configured to look for suspicious binaries or script code in email attachments (opensource example isCuckoo Sandbox https://cuckoosandbox.org/ ). If an attachment is found to be suspious it should be blocked (if there is a mechanism to do so) and an alert should be generated. ",,,,,,,,,,
,,Email Sender Domain Newly Registered ,Threat Intel|Email,"If the domain name of an email sender has been registered within the lasst [x] days (recommendation is 3), it should be considered as suspicious. An alert should be generated for each domain that is detected, and that alert should contain an aggregate of all emails sent from this domain. This use case depends on obtaining the sender domain and running it against up-to-date whois data to verify when the domain was registered. If this alert is seen within an organisation, it is likely that a phishing campaign may be happening. ",,,,,,,,,,
,,Email Sender Domain Unresolved,Threat Intel|Email,"If a domain does not resolve to an IP address, this is usually a sign that a dns record was created and forged for the purposes of staging attacks. Rarely does somebody create a domain or subdomain and forget to assign an IP address. This use case correlates with Whois data and information and looks up whether the domain resolves to an IP. ",,,,,,,,,,
,,High Entropy Email Sender Address ,Email|Email Gateway,An email address that has a high entropy score (meaning the occurance an email contains random characters) is usually indicative that the sender address is not legitimate. This type of activity or behaviour is often carried out by spam campaigns or phishing campaigns. This correlation will depend on tools that can rate the frequency of string matches. One such open source tool is freq.py (link) which does this. The output is a frequency score. Applying this tool and correlating with other sources will be highlighted in other use cases in this library. ,,,,,,,,,,
,,High Entropy Email Subject,Email|Email Gateway,Email Phishing campaigns that are opportunistic often have subjects that contain high entropy strings in the subject.,,,,,,,,,,
,,Suspicious Email Campaign - Subject line [Single Sender],Email|Email Gateway|Email Sandbox,"There are multiple patterns that an email campaign is delivered. One method is from a single email sender, delivered to multiple recipients. When analyzing malware campaigns, and looking at subject lines, there are multiple subject line strings that are common amongst them. This use case matches specific strings in a given list with the subject line  delivered to a specified number of recipients.",,,,,,,,,,
,,Suspicious Email Campaign - attachment [Single Sender],Email|Email Gateway|Email Sandbox,"There are multiple patterns that an email campaign is delivered. One method is from a single email sender, delivered to multiple recipients. When analyzing malware campaigns, and looking at subject lines, there are multiple subject line strings that are common amongst them. This use case matches specific strings in a  subject line  delivered to a specified number of recipients ",,,,,,,,,,
,,Suspicious Email Campaign [Multiple Sender|Multiple Subjects],Email|Email Gateway,"This is another pattern in which email campaigns are delivered. Cybercriminals that understand detection of email campaigns from different senders can be easily mitgated by blocking the send, hence they have developed tactics which deliver an email multiple email subjects from multiple users. This use case will rely on threat intelligence, correlation list and machine learning to determine how specific subject lines and email addresses tie back to the same campaign based on pattern matching techniques, pivot and contextual data and time based factors. ",,,,,,,,,,
,,Exploit Code Detected [IDS/IPS],IDS/IPS|Exploit,"Exploit related signatures on the perimeter IPS/IDS indicate that an attacker is trying to penetrate the network. These are server-side exploits and can eitherr be part of delivery or, if successful, can be an attackers point of Initial access. ",,,,,,"These alerts should be looked at and verified if successful. The usual way this acitivity is successful is if  the attacked system shows signs of compormise. In other words, there needs to be additional detective and forensic controls such as an EDR, Application whitelisting and/or logging processes with command line on the system.",,,,
,,Web Attack Detected [WAF],WAF|Web,Web application firewall actiivty indicate that an attack is attempting to potentially exploit weakness on your web applications. ,,,,,,"Depending on the WAF policy, if the WAF rules triggered are not in blocking mode, it is recommended that they be put in block mode. 
Secondly, the web server holding the application that was attacked should be investigated for signes of compromise. Addtional  detective and c controls such as an EDR, Application whitelisting and/or logging processes with command line on the system.",,,,
,"Adversary OPSEC|Compromise 3rd party infrastructure to support delivery|Initial Access|Drive By Compromise
",Potential Watering Hole Attack Detected,Proxy|Threat Intel,This use case attempts to correlate proxy logs with known watering hole attacks gathered from threat intelligence. This threat intelligence can be gathered by a provider or gathered by profiling traffic from proxy servers. ,,,,,,,,,https://attack.mitre.org/wiki/Group/G0066,
,"Adversary OPSEC|Compromise 3rd party infrastructure to support delivery|Initial Access|Drive By Compromise
",Exploit Kit Detected [IDS/IPS],IDS/IPS|Client side,Exploit Kit signatures should be enabled on your IDS/IPS perimeter solutions. Signatures triggered by the IDS should immediately be looked at for signs of compromise. If an IPS solution has exploit signatures ,,,,,,,,,,
,,Exploit Kit Detected [Threat Intel],Threat Intel|Network,"This use case correlates known exploit kit infrastructure with proxy, firewall,dns and other network sources. A good threat Intel Provider, or theat intel feeds should classify data and infrastracture.",,,,,,,,,,
,,,,,,,,,,,,,,
Initial Access,,,,,,,,,,,,,,
,,Malware Techiques,,,,,,,,,,,,
"Client side exploit, Server Side exploit C2 download",,Successful Exploitation - IDS Detection,,,,,,,,,,,,
,Explloit Public-Facing Application,Shell Access Detected,Windows Security Logs|Command Line|Web Application,This use case detects Shell access granted to a user from an external source address. T,,,,,,,,,,
,,Web Injection Attack Detected,,,,,,,,,,,,
,Explloit Public-Facing Application,Web Attack Detected [IDS/IPS],,,,,,,,,,,,
,Explloit Public-Facing Application,Exploit Code Detected [IDS/IPS],,,,,,,,,,,,
,Explloit Public-Facing Application,Web Attack Detected [WAF],,,,,,,,,,,,
,Drive by Compromise,Exploit Kit Detected [IDS/IPS],,,,,,,,,,,,
,Drive by Compromise,Watering Hole,,,,,,,,,,,,
,Drive by Compromise,XSS,,,,,,,,,,,,
,Drive by Compromise,XRSF,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,Malware C2 - IPS Signature for C2 triggered,,,,,,,,,,,,
,,Malware C2 - Threat Intelligence Correlation,,,,,,,,,,,,
,,Malware C2 - Newly Registered Domain,,,,,,,,,,,,
,,Malware C2 - User Agent String - Known Bad,,,,,,,,,,,,
,,Malware C2 - User Agent String - New,,,,,,,,,,,,
,,Malware C2 - User Agent String - Rare,,,,,,,,,,,,
,,Malware C2 - DGA Generated Domain,,,,,,,,,,,,
,,Malware C2 - Direct to IP,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
Line of Failure,,,,Line of Failure,,,Line of Failure,,,,,Line of Failure,,
Foothold,,,,,,,,,,,,,,
"Second stage download, memory attack of binary",,Second Stage Exetutable,,,,,,,,,,,,
,,Establish Backdoor ,,,,,,,,,,,,
,,Establish Persitence Mechanisms,,,,,,,,,,,,
,,Windows - Startup Item,,,,,,,,,,,,
,,Windows - Persistent Registry Entry,,,,,,,,,,,,
,,Windows - Scheduled Task,,,,,,,,,,,,
,,Windows Firewall Disabled,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,SNMP Enumeration,,,,,,,,,,,,
,,Lateral Movement,,,,,,,,,,,,
,,harvest credentials,,,,,,,,,,,,
,,RDP Exploitation,,,,,,,,,,,,
Propagation,,,,,,,,,,,,,,
,,Powershell invoked by WMIC,,,,,,,,,,,,
"i.e. Lateral movement, post breach enumeration, credential harvesting, post breach exploitation",,Suspicious PsExec Binary detected,,,,,,,,,,,,
,,SNMP Walk,,,,,,,,,,,,
,,Windows - Event log was cleared,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
Extraction,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,Destruction of media,,,,,,,,,,,,
,,Exfiltration of Data,,,,,,,,,,,,
,,Access Data,,,,,,,,,,,,
,,Honey DB Account Activity,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
Objectives/Monetization,,,,,,,,,,,,,,
,,Denial of Service,,,,,,,,,,,,
,,Compromise of email,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
,,,,,,,,,,,,,,
