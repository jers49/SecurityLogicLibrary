Impact Kill Chain,Mitre [PRE & POST ATT&CK],Use Case,Tag,Description,Impact,Dependencies,Detection Maturity ,Detection Logic,Output,Response,Comment,References,Motivation/Group/Actor,Use Case Author,,,,,,,
Reconnaissance,,,,,,,,,,,,,,,,,,,,,Experimental
Reconnaissance,Technical Information Gathering|Discover target logon/email address format,Honey Email Token,Email Gateway,"A Honey email token is an email account that is placed in an organisation's public information sources for the purpose of detecting phishing campaigns, email address enumeration and spear phishing attempts (depending on the potential profile attached with the email address). Depending on the size of the organization will determine how many Honey Email tokens are created. Detection Logic should look for any activity that involve these email tokens as there is a high chance that this activity will indicate that an attacker/potential threat is looking for vulnerable users to exploit.",Medium,"* Email Gateway Logs
* Exchange Logs
* List of Honey Email Tokens
* Approval to implement Tokens
* Fake social media sites
* Hidden Email contacts in web page contents",Stable,,Alert and/or Report,"Determine Sending IP Address, Sender Email, Subject line, Attachments
Pivot on All values to determine if there are any commonalities to the delivery
Add the suspicious indicators to a list (to be used for later threat intelligence gathering)
Determine if this correlates with additional alerts related to phishing/spear phishing. 
If sender IP/Domain is suspicious - ensure they are blocked on Firewall/Email Gateway/Exchange ",,,,,,,,,,,Functional
Reconnaissance,NA,Honeynet Activity,Network,"A Honeynet is a separate network that impersonates part of your corporate network but is used to bait out threats that are targeting your organization. Fake data and applications are set up in order to imitate a real network. Sensors and security controls should be set up in the environment in order to specifically detect attacker activity. Detecting honeynet is an extremely effective way to detect threat activity and determine their behaviour. This use case is in the reconnaissance category because its main purpose is to detect an attackers methods, actions and objectives. ",High,"* Network Segment designed to be a honeynet
* Security Controls such as EDR, NSM, IPS/IDS, Bro, Forensics
* Command Line logging
* Central logging /SIEM",,,,,,,,,,,,,,,Stable
Reconnaissance,NA,Honey Site Activity,Web Application,"Similar to a Honeynet, a Honey Site is a honeypot used for detecting and determining web based attacks. ",,,,,,,,,,,,,,,,,Informational
Reconnaissance,NA,Supply Chain Reconnaissance using OSINT,,,,,,,,,,,,,,,,,,,
Reconnaissance, Technical Information Gathering|Conduct active scanning,External port scan [Firewall],Firewall,External Port Scan can be detected using either firewall log activity or IDS/IPS signatures. The benefit of this is to give context of which systems in your external environment are being scoped/targeted. This information should be used in reporting and threat intelligence gathering. ,Low,,,,,,,,,,,,,,,,
Reconnaissance, Technical Information Gathering|Conduct active scanning,External port scan [IDS/IPS],IDS/IPS,External Port Scan can be detected using either firewall log activity or IDS/IPS signatures. The benefit of this is to give context of which systems in your external environment are being scoped/targeted. This information should be used in reporting and threat intelligence gathering. ,Low,,,,,,,,,,,,,,,,
Reconnaissance, Technical Information Gathering|Conduct active scanning,External Ping Sweep [Firewall],Firewall,"External Ping Sweeps, like port scans, can also be detected using Network IDS/IPS, or WAF. The benefit of this is to give context of which systems in your external environment are being scoped/targeted. This information should be used in reporting and threat intelligence gathering.",Low,,,,,,,,,,,,,,,,
Reconnaissance, Technical Information Gathering|Conduct active scanning,External Ping Sweep [IDS/IPS],IDS/IPS,"External Ping Sweeps, like port scans, can also be detected using Network IDS/IPS, or WAF. The benefit of this is to give context of which systems in your external environment are being scoped/targeted. This information should be used in reporting and threat intelligence gathering.",Low,,,,,,,,,,,,,,,,
Reconnaissance,Technical Weakness Identification|Analyze application security posture,External Vulnerability Scan [IDS/IPS],IDS/IPS,"External Vulnerability Scans are indicative of a more serious threat than just port scans or ping sweeps. Any actor at this stage of  the attack life cycle is most likely looking for low hanging fruit (easily compromisable) vulnerabilities, or is heavily profiling the environment. External vulnerability scans should be done regularly by the vulnerability assessment/management team and their activity should be whitelisted and everything else blocked from the perimeter. This information should be used in reporting and threat intelligence gathering.",Medium,,,,,,,,,,,,,,,,
Reconnaissance,Technical Weakness Identification|Analyze application security posture,External Vulnerability Scan [WAF],IDS/IPS,"Just like External vulnerability scans,  this detection and prevention mechanism is done by the Web Application Firewall and focuses on web application attacks. Any actor at this stage of  the attack life cycle is most likely looking for low hanging fruit (easily compromisable) vulnerabilities, or is heavily profiling the environment. External vulnerability scans should be done regularly by the vulnerability assessment/management team and their activity should be whitelisted and everything else blocked from the perimeter. This information should be used in reporting and threat intelligence gathering.",Medium,,,,,,,,,,,,,,,,
Reconnaissance,,Local File Inclusion attempt [IDS/IPS],IDS/IPS|Web Attack,Attackers often test multiple vulnerabilities on web applications. An IPS should be able to detect this type of activity and this activity should be investigated. The activity information should also be used for reporting and intelligence gathering,,,,,,,,,,,,,,,,,
Reconnaissance,,Local File Inclusion attempt [Reverse Proxy],Reverse Proxy| Web Attack,A reverse proxy is a good mechanism to detect attackers performing reconnaissance on web servers. This includes looking for local file inclusion attempts.,,,,,,,,,,,,,,,,,
Reconnaissance,,Web application information gathering detected [Reverse Proxy] ,Reverse Proxy| Web Attack,TBD,,,,,,,,,,,,,,,,,
Reconnaissance,,External Zone Transfer Request Detected [DNS],DNS,"Depending on your organizations DNS infrastructure (Split DNS or single DNS), you can detect DNS transfer request either by DNS logging and querying for zone transfer requests in the logs, or alternatively, look for Firewall/IDS traffic on port 53 using the TCP protocol. This use case has multiple entries, one for each detection logic.",Medium,,,,,,,,,,,,,,,,
Reconnaissance,,External Zone Transfer Request Detected [Firewall],Firewall,"Depending on your organizations DNS infrastructure (Split DNS or single DNS), you can detect DNS transfer request either by DNS logging and querying for zone transfer requests in the logs, or alternatively, look for Firewall/IDS traffic on port 53 using the TCP protocol. This use case has multiple entries, one for each detection logic.",Medium,,,,,,,,,,,,,,,,
Reconnaissance,,External Zone Transfer Request Detected [IDS/IPS],IDS/IPS,"Depending on your organizations DNS infrastructure (Split DNS or single DNS), you can detect DNS transfer request either by DNS logging and querying for zone transfer requests in the logs, or alternatively, look for Firewall/IDS traffic on port 53 using the TCP protocol. This use case has multiple entries, one for each detection logic.",Medium,,,,,,,,,,,,,,,,
Reconnaissance,,Sensitive Data Exposure[IDS/IPS],OWASP|A3:2017|IDS/IPS|Bro,This use case determines whether externally facing web servers have weak encryption or no encryption. Transmitted data in clear text is susceptible to sniffing attacks.,,,,,,,,,,,,,,,,,
Reconnaissance,,XML External Entities [IDS/IPS],OWASP|A4:2017|IDS/IPS,This looks for attempts to extract inforation out of misconfigured xml content by checking for the queries.,,,,,,,,https://www.owasp.org/index.php/Top_10-2017_A4-XML_External_Entities_(XXE),,,,,,,,,
Reconnaissance,,Threat Intel Activity [Inbound IP Address],Threat Intel|Network,"This Use Case is mainly used as a form of reporting on any perimeter activity. This is a report based use case. This use case will heavily rely on the confidence rating  of an IOC and its relevancy to the organization. For example, if in financial services/banking, ensure financial related indicators and attacker group IP addresses are predominantly used. Secondly, ensure that the report will sort based on the confidence rating of a particular IP. The most important thing to get from this information is knowledge about who and when a potential threat is scanning your organization, and prepare for a pre-emptive attack. This use case is dependant on how accurate, and current your threat intelligence feeds are and how well the feeds contextualize the data.",Medium,*Threat Intelligence feed,,,,,,,,,,,,,,,
Delivery,,,,,,,,,,,,,,,,,,,,,
Delivery,,Threat Intel Activity [High Confidence IP Address Hosting known attack infrastructure],Threat Intel|Network,"This Use Case has a heavy dependency on a threat intel provider, or your own organizations threat intelligence to have a confidence rating or accuracy and context of the threat intelligence. In other words, the IP addresses that correlates with threat intel information would need to be confirmed from a specific threat or ttp that would target your industry/vertical and not just derived from a generic sample of IOC's. This is a good indicator that your organisation is being targeted by sophisticated threat, or known opportunistic groups.",Medium,,,,,,,,,,,,,,,,
Delivery,,Threat Intel Activity [Email Sender Address],Threat Intel|Email,"This use case correlates email addresses from gathered threat intelligence, that have been used or are being used by attackers. ",,,,,,,,,,,,,,,,,
Delivery,,Suspicious Email Payload Detected,Email Sanbox,"This use case depends on whether an email sanbox has been set up the corporate network environment, and whether that has been configured to look for suspicious binaries or script code in email attachments (opensource example is Cuckoo Sandbox https://cuckoosandbox.org/ ). If an attachment is found to be suspious it should be blocked (if there is a mechanism to do so) and an alert should be generated. ",,,,,,,,,,,,,,,,,
Delivery,,Suspicious Email Link Detected,Email Sanbox,"This use case depends on whether an email sanbox has been set up the corporate network environment, and whether that has been configured to look for suspicious binaries or script code in email attachments (opensource example is Cuckoo Sandbox https://cuckoosandbox.org/ ). If an attachment is found to be suspious it should be blocked (if there is a mechanism to do so) and an alert should be generated. ",,,,,,,,,,,,,,,,,
Delivery,,Email Sender Domain Newly Registered ,Threat Intel|Email,"If the domain name of an email sender has been registered within the last [x] days (recommendation is 3), it should be considered as suspicious. An alert should be generated for each domain that is detected, and that alert should contain an aggregate of all emails sent from this domain. This use case depends on obtaining the sender domain and running it against up-to-date whois data to verify when the domain was registered. If this alert is seen within an organisation, it is likely that a phishing campaign may be happening. ",,,,,,,,,,,,,,,,,
Delivery,,Email Sender Domain Unresolved,Threat Intel|Email,"If a domain does not resolve to an IP address, this is usually a sign that a dns record was created and forged for the purposes of staging attacks. Rarely does somebody create a domain or subdomain and forget to assign an IP address. This use case correlates with Whois data and information and looks up whether the domain resolves to an IP. ",,,,,,,,,,,,,,,,,
Delivery,,High Entropy Email Sender Address ,Email|Email Gateway,An email address that has a high entropy score (meaning the occurrence an email contains random characters) is usually indicative that the sender address is not legitimate. This type of activity or behaviour is often carried out by spam campaigns or phishing campaigns. This correlation will depend on tools that can rate the frequency of string matches. One such open source tool is freq.py (link) which does this. The output is a frequency score. Applying this tool and correlating with other sources will be highlighted in other use cases in this library. ,,,,,,,,,,,,,,,,,
Delivery,,High Entropy Email Subject,Email|Email Gateway,Email Phishing campaigns that are opportunistic often have subjects that contain high entropy strings in the subject.,,,,,,,,,,,,,,,,,
Delivery,,Suspicious Email Campaign - Subject line [Single Sender],Email|Email Gateway|Email Sandbox,"There are multiple patterns that an email campaign is delivered. One method is from a single email sender, delivered to multiple recipients. When analysing malware campaigns, and looking at subject lines, there are multiple subject line strings that are common amongst them. This use case matches specific strings in a given list with the subject line  delivered to a specified number of recipients.",,,,,,,,,,,,,,,,,
Delivery,,Suspicious Email Campaign - attachment [Single Sender],Email|Email Gateway|Email Sandbox,"There are multiple patterns that an email campaign is delivered. One method is from a single email sender, delivered to multiple recipients. When analysing malware campaigns, and looking at subject lines, there are multiple subject line strings that are common amongst them. This use case matches specific strings in a  subject line  delivered to a specified number of recipients ",,,,,,,,,,,,,,,,,
Delivery,,Suspicious Email Campaign [Multiple Sender|Multiple Subjects],Email|Email Gateway,"This is another pattern in which email campaigns are delivered. Cybercriminals that understand detection of email campaigns from different senders can be easily mitigated by blocking the send, hence they have developed tactics which deliver an email multiple email subjects from multiple users. This use case will rely on threat intelligence, correlation list and machine learning to determine how specific subject lines and email addresses tie back to the same campaign based on pattern matching techniques, pivot and contextual data and time based factors. ",,,,,,,,,,,,,,,,,
Delivery,,Exploit Code Detected [IDS/IPS],IDS/IPS|Exploit,"Exploit related signatures on the perimeter IPS/IDS indicate that an attacker is trying to penetrate the network. These are server-side exploits and can either be part of delivery or, if successful, can be an attackers point of Initial access. ",,,,,,"These alerts should be looked at and verified if successful. The usual way this activity is successful is if  the attacked system shows signs of compromise. In other words, there needs to be additional detective and forensic controls such as an EDR, Application whitelisting and/or logging processes with command line on the system.",,,,,,,,,,,
Delivery,,Web Attack Detected [WAF],WAF|Web,Web application firewall activity indicate that an attack is attempting to potentially exploit weakness on your web applications. ,,,,,,"Depending on the WAF policy, if the WAF rules triggered are not in blocking mode, it is recommended that they be put in block mode. 
Secondly, the web server holding the application that was attacked should be investigated for signs of compromise. Additional  detective and c controls such as an EDR, Application whitelisting and/or logging processes with command line on the system.",,,,,,,,,,,
Delivery,"Adversary OPSEC|Compromise 3rd party infrastructure to support delivery|Initial Access|Drive By Compromise
",Potential Watering Hole Attack Detected,Proxy|Threat Intel,This use case attempts to correlate proxy logs with known watering hole attacks gathered from threat intelligence. This threat intelligence can be gathered by a provider or gathered by profiling traffic from proxy servers. ,,,,,,,,,https://attack.mitre.org/wiki/Group/G0066,,,,,,,,
Delivery,"Adversary OPSEC|Compromise 3rd party infrastructure to support delivery|Initial Access|Drive By Compromise
",Exploit Kit Detected [IDS/IPS],IDS/IPS|Client side,Exploit Kit signatures should be enabled on your IDS/IPS perimeter solutions. Signatures triggered by the IDS should immediately be looked at for signs of compromise. If an IPS solution has exploit signatures ,,,,,,,,,,,,,,,,,
Delivery,,Exploit Kit Detected [Threat Intel],Threat Intel|Network,"This use case correlates known exploit kit infrastructure with proxy, firewall, dns and other network sources. A good threat Intel Provider, or threat intel feeds should classify data and infrastructure.",,,,,,,,,,,,,,,,,
Delivery,,Binary inside Email Attachment [IDS/IPS],,"This detection attempts to detect any bindaries within an email attachment. This is based on signature detection, sanboxing technologies and packet analysis. ",,,,,,,,,,,,,,,,,
Delivery,,Web Injection Attack Detected [IDS/IPS],OWASP|A1:2017|IDS/IPS|,"This use case triggers on Injection specific Intrusion events that were not blocked on the perimeter. The logic is to query any signatures that are related to web injection attacks on web servers, applications or databases. ",,,,,,,,,,,,,,,,,
Delivery,Exploit Public-Facing Application,Web Attack Detected [IDS/IPS],,This att,,,,,,,,,,,,,,,,,
Delivery,Exploit Public-Facing Application,Exploit Code Detected [IDS/IPS],,,,,,,,,,,,,,,,,,,
Delivery,Exploit Public-Facing Application,Web Attack Detected [WAF],,,,,,,,,,,,,,,,,,,
Delivery,Drive by Compromise,Exploit Kit Detected [IDS/IPS],,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,
Line of Failure,,,,Line of Failure,,,,,,,,Line of Failure,,,,,,,,,
Bypass,,,,,,,,,,,,,,,,,,,,,
Bypass,,Malware Techniques,,,,,,,,,,,,,,,,,,,
Bypass,Exploit Public-Facing Application,Suspicious Shell Access Detected on Web Server,Windows Security Logs|Command Line|Web Application,This use case will detected any internet facing web servers that invoke command line or shell access. This will indicate that an attacker was able to successfully run an exploit and gain command line access to an internet facing server. ,,,,Detection logic,,,,,,,,,,,,,
Bypass,Exploit Public-Facing Application,Cross Site Scripting Detected [IDS/IPS],Web Application|Web Server|IDS/IPS,The purpose of this use case is to detect cross site scripting attacks being hosted on corporate owned web servers. ,,,,,,,,,,,,,,,,,
Bypass,Exploit Public-Facing Application,Cross Site Scripting Compromise Detected [EDR/Endpoint],Web Server|EDR|HIDS,This detection looks for signs of exploitation off cross site scripting vulnerabilities on the endpoint. Signs of exploitation ,,,,,,,,,,,,,,,,,
Bypass,,Suspicious binary executed from temp folder ,HIDS|EDR|Endpoint|Antivirus,This detection looks for signs of exploitation off cross site scripting vulnerabilities on the endpoint. Signs of exploitation looks for the tampering of common vectors susch as login.php scripts,,,,,,,,,,,,,,,,,
Bypass,,Suspicious binary executed from USB,,Suspicious binary executed by autoruns.inf via USB. Binary execution includes,,,,,,,,,,,,,,,,,
Bypass,,Malware C2 - IPS Signature for C2 Triggered,,,,,,,,,,,,,,,,,,,
Bypass,,Malware C2 - Threat Intelligence Correlation,,,,,,,,,,,,,,,,,,,
Bypass,,Malware C2 - Newly Registered Domain,,,,,,,,,,,,,,,,,,,
Bypass,,Malware C2 - Known Bad User Agent String ,IDS/IPS,,,,,,,,,,,,,,,,,,
Bypass,,Malware C2 - New User Agent String,,,,,,,,,,,,,,,,,,,
Bypass,,Malware C2 - Rare User Agent String ,,,,,,,,,,,,,,,,,,,
Bypass,,Malware C2 - DGA Generated Domain Detected,,,,,,,,,,,,,,,,,,,
Bypass,,Malware C2 - Direct to IP,,,,,,,,,,,,,,,,,,,
Bypass,,Suspicious Commands detected on Web Servers,,,,,,,,,,,,,,,,,,,
Bypass,,Suspicious WMI Invoking Powershell,,,,,,,,,,,,,,,,,,,
Bypass,,Suspicious cmd.exe Invoking Powershell,,,,,,,,,,,,,,,,,,,
Bypass,,Suspicious WMI invoking cmd.exe,,,,,,,,,,,,,,,,,,,
Bypass,,,,,,,,,,,,,,,,,,,,,
Bypass,,,,,,,,,,,,,,,,,,,,,
Foothold,,,,,,,,,,,,,,,,,,,,,
Foothold,,Second Stage Executable,,,,,,,,,,,,,,,,,,,
Foothold,,Establish Backdoor ,,,,,,,,,,,,,,,,,,,
Foothold,,Establish Persistence Mechanisms,,,,,,,,,,,,,,,,,,,
Foothold,,Windows - Startup Item,,,,,,,,,,,,,,,,,,,
Foothold,,Windows - Persistent Registry Entry,,,,,,,,,,,,,,,,,,,
Foothold,,Windows - Scheduled Task,,,,,,,,,,,,,,,,,,,
Foothold,,Windows Firewall Disabled,,,,,,,,,,,,,,,,,,,
Foothold,,,,,,,,,,,,,,,,,,,,,
Foothold,,,,,,,,,,,,,,,,,,,,,
Foothold,,,,,,,,,,,,,,,,,,,,,
Foothold,,,,,,,,,,,,,,,,,,,,,
Foothold,,,,,,,,,,,,,,,,,,,,,
Foothold,,,,,,,,,,,,,,,,,,,,,
Foothold,,SNMP Enumeration,,,,,,,,,,,,,,,,,,,
Foothold,,Lateral Movement,,,,,,,,,,,,,,,,,,,
Foothold,,harvest credentials,,,,,,,,,,,,,,,,,,,
Foothold,,RDP Exploitation,,,,,,,,,,,,,,,,,,,
"Propagation (i.e. Lateral movement, post breach enumeration, credential harvesting, post breach exploitation)",,,,,,,,,,,,,,,,,,,,,
Propagation,,PowerShell invoked by WMIC,,,,,,,,,,,,,,,,,,,
Propagation,,Suspicious PsExec Binary detected,,,,,,,,,,,,,,,,,,,
Propagation,,SNMP Walk,,,,,,,,,,,,,,,,,,,
Propagation,,Windows - Event log was cleared,,,,,,,,,,,,,,,,,,,
Propagation,,,,,,,,,,,,,,,,,,,,,
Propagation,,,,,,,,,,,,,,,,,,,,,
Propagation,,,,,,,,,,,,,,,,,,,,,
Propagation,,,,,,,,,,,,,,,,,,,,,
Propagation,,,,,,,,,,,,,,,,,,,,,
Extraction,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,
,,Destruction of media,,,,,,,,,,,,,,,,,,,
,,Exfiltration of Data,,,,,,,,,,,,,,,,,,,
,,Access Data,,,,,,,,,,,,,,,,,,,
,,Honey DB Account Activity,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,
Objectives/Monetization,,,,,,,,,,,,,,,,,,,,,
,,Denial of Service,,,,,,,,,,,,,,,,,,,
,,Compromise of email,,,,,,,,,,,,,,,,,,,
